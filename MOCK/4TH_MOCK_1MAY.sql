-- SELECT E1.ENAME EMP_ENAME, D1.DNAME EMP_DNAME , E2.ENAME MGR_ENAME , D2.DNAME MGR_DNAME, E3.ENAME "MGRS MGR_ENAME" , D3.DNAME "MGRS MGR_DNAME"
-- FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2 
-- ON E1.MGR = E2.EMPNO
-- JOIN SCOTT.EMP E3
-- ON E2.MGR = E3.EMPNO
-- INNER JOIN SCOTT.DEPT D1
-- ON E1.DEPTNO = D1.DEPTNO
-- INNER JOIN SCOTT.DEPT D2
-- ON E2.DEPTNO = D2.DEPTNO 
-- INNER JOIN SCOTT.DEPT D3
-- ON E3.DEPTNO = D3.DEPTNO 

-- 1] WAQTD ENAME & DNAME OF AN EMP WHO IS WORKING AS A
-- CLERK IN THE DALLAS.
 

SELECT ENAME,  SAL, DEPT.LOC, DEPTNO
FROM SCOTT.EMP INNER JOIN SCOTT.DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE SAL > (SELECT SAL
            FROM SCOTT.EMP
            WHERE ENAME = 'TURNER') AND
            DEPTNO IN (10, 30);

SELECT ENAME , DNAME 
FROM SCOTT.EMP INNER JOIN SCOTT.DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE HIREDATE > (SELECT HIREDATE
                FROM SCOTT.EMP
                WHERE ENAME = 'JONES') AND
        DEPT.DNAME IN (SELECT DNAME
                        FROM SCOTT.DEPT
                        WHERE ENAME IN (SELECT ENAME
                                        FROM SCOTT.DEPT
                                        WHERE ENAME = 'FORD'));

SELECT E1.ENAME EMP_NAME , E2.ENAME MDR_NAME
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2
ON E1.MGR = E2.EMPNO
WHERE E1.ENAME LIKE '%R%' AND
        E2.ENAME NOT LIKE '%R%';

SELECT E1.ENAME EMP_NAME, E1.JOB EMP_JOB ,E1.HIREDATE EMP_HIREDATE, E2.ENAME MGR_NAME, E2.JOB MGR_JOB, E2.HIREDATE MGR_HIREDATE
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2
ON E1.MGR = E2.EMPNO
WHERE E1.JOB IN (SELECT JOB
                FROM SCOTT.EMP
                WHERE ENAME = 'ALLEN') AND
    E2.JOB IN (SELECT JOB
                FROM SCOTT.EMP
                WHERE ENAME = 'CLARK') AND
        E1.HIREDATE LIKE '%FEB%' AND
        E2.HIREDATE LIKE '%MAY%'; 

SELECT E1.ENAME EMP_NAME, D1.DNAME  EMP_DNAME, E2.ENAME MGR_NAME, D2.DNAME MGR_DNAME
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2
ON E1.MGR = E2.EMPNO
INNER JOIN SCOTT.DEPT D1
ON E1.DEPTNO = D1.DEPTNO
INNER JOIN SCOTT.DEPT D2
ON E2.DEPTNO = D2.DEPTNO AND
    E1.SAL > (SELECT MIN(SAL)
            FROM SCOTT.EMP
            WHERE SAL > (SELECT MIN(SAL)
                        FROM SCOTT.EMP)) AND
E2.SAL < (SELECT MAX(SAL)
            FROM SCOTT.EMP
            WHERE SAL < (SELECT MAX(SAL)
                        FROM SCOTT.EMP)) AND
        E1.HIREDATE LIKE '%82';

SELECT E1.ENAME EMP_ENAME,E2.ENAME MGR_ENAME , E3.ENAME "MGRS MGR_ENAME" 
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2 
ON E1.MGR = E2.EMPNO
JOIN SCOTT.EMP E3
ON E2.MGR = E3.EMPNO AND
E1.DEPTNO IN (10, 20) AND
E2.JOB IN ('MANAGER', 'SALESMAN') AND
E3.SAL > (SELECT MAX(SAL)
        FROM SCOTT.EMP);

SELECT E1.ENAME EMP_ENAME, D1.LOC EMP_LOC , E2.ENAME MGR_ENAME , D2.LOC MGR_LOC, E3.ENAME "MGRS MGR_ENAME" , D3.LOC "MGRS MGR_DNAME"
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2 
ON E1.MGR = E2.EMPNO
JOIN SCOTT.EMP E3
ON E2.MGR = E3.EMPNO
INNER JOIN SCOTT.DEPT D1
ON E1.DEPTNO = D1.DEPTNO
INNER JOIN SCOTT.DEPT D2
ON E2.DEPTNO = D2.DEPTNO 
INNER JOIN SCOTT.DEPT D3
ON E3.DEPTNO = D3.DEPTNO AND
E1.DEPTNO IN (SELECT DEPTNO
            FROM SCOTT.EMP
            WHERE ENAME IN ('MARTIN', 'FORD')) AND
            E2.DEPTNO = E3.DEPTNO;

SELECT E1.ENAME EMP_ENAME, E1.JOB EMP_JOB, E1.HIREDATE EMP_HD, D1.DNAME EMP_DNAME , E2.ENAME MGR_ENAME , E2.JOB MGR_JOB, E2.HIREDATE MGR_HD, D2.DNAME MGR_DNAME
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2 
ON E1.MGR = E2.EMPNO
INNER JOIN SCOTT.DEPT D1
ON E1.DEPTNO = D1.DEPTNO
INNER JOIN SCOTT.DEPT D2
ON E2.DEPTNO = D2.DEPTNO AND
E1.HIREDATE LIKE '%81' AND
E1.COMM IS NULL AND
E2.COMM IS NULL AND
D1.LOC != D2.LOC ;
-- D2.LOC != D2.LOC;

SELECT E1.ENAME EMP_ENAME, D1.DNAME EMP_DNAME , E2.ENAME MGR_ENAME , D2.DNAME MGR_DNAME
FROM SCOTT.EMP E1 JOIN SCOTT.EMP E2 
ON E1.MGR = E2.EMPNO
INNER JOIN SCOTT.DEPT D1
ON E1.DEPTNO = D1.DEPTNO
INNER JOIN SCOTT.DEPT D2
ON E2.DEPTNO = D2.DEPTNO AND
E1.SAL IN (SELECT MAX(SAL)
            FROM SCOTT.EMP
            WHERE SAL < (SELECT MAX (SAL)
                        FROM SCOTT.EMP
                        WHERE SAL < (SELECT MAX(SAL)
                                    FROM SCOTT.EMP
                                    WHERE SAL < (SELECT MAX(SAL)
                                    FROM SCOTT.EMP))));


SELECT *
FROM SCOTT.EMP;